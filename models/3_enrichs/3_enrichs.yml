version: 2

models:
  - name: customer_orders__curate
    meta:
     metriql:
      measures:
        count_of_customer_orders:
          aggregation: count
          column: count_of_customer_orders
        count_of_customer_orders_completed:
          aggregation: count
          column: customer_historical_value
          filters: [{dimension: customer_order_status, operator: '=', value: 'completed'}]
        first_order:
          aggregation: min
          column: order_date
        most_recent_order:
          aggregation: max
          column: order_date         
        # total_customer_historical_value:
        #   aggregation: sum
        #   column: customer_historical_value
        # total_customer_historical_value_completed:
        #   aggregation: sum
        #   column: customer_historical_value
        #   filters: [{dimension: customer_order_status, operator: '=', value: 'completed'}]
    columns:
      - name: order_id
      - name: customer_id
      - name: order_date
      - name: customer_order_status
      - name: is_completed
